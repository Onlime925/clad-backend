import{a as q}from"./chunk-ADNKO6P7.js";import"./chunk-45XQNQLX.js";import"./chunk-MJECYTMO.js";import"./chunk-UTHYR4ZI.js";import{a as U,b as v,c as A,d as T,f as O,g as R,h as V,l as W,m as D,n as G}from"./chunk-CAQNE6RI.js";import{a as P}from"./chunk-CUAKDJGI.js";import"./chunk-E2K66LD7.js";import{a as M}from"./chunk-HXH56C36.js";import{e as k}from"./chunk-FLL3NRM6.js";import{c as I,d as _,e as F,h as w,q as L,s as N,x as j}from"./chunk-GLZSOAJQ.js";import{Ka as a,La as f,W as y,Wa as u,Ya as c,cb as i,db as t,eb as h,ib as E,jb as g,ob as n,qb as b,ub as C,wb as S}from"./chunk-B5DXUUC7.js";import{d as x}from"./chunk-4CLCTAJ7.js";var B=r=>({"d-none":r});function J(r,d){if(r&1&&(i(0,"div",30),n(1),t()),r&2){let o=g();a(),b(" ",o.myFormService.getErrorMessage(o.form.controls.name)," ")}}function K(r,d){if(r&1&&(i(0,"div",30),n(1),t()),r&2){let o=g();a(),b(" ",o.myFormService.getErrorMessage(o.form.controls.email)," ")}}function Q(r,d){if(r&1&&(i(0,"div",30),n(1),t()),r&2){let o=g();a(),b(" ",o.myFormService.getErrorMessage(o.form.controls.password)," ")}}function X(r,d){if(r&1&&(i(0,"div",31),h(1,"input",32),i(2,"label",33),n(3),t()()),r&2){let o=d.$implicit,m=g();a(),c("name",o)("checked",m.checked.includes(o))("id",o)("value",o),a(),c("for",o),a(),b(" ",o.replaceAll("."," ").replaceAll("_"," ")," ")}}var pe=(()=>{let d=class d{constructor(m,s,e,l,p,H,$,z){this.fb=m,this.notification=s,this.myFormService=e,this.service=l,this.route=p,this.router=H,this.lang=$,this.websiteService=z,this.default="",this.formLoader=!1,this.editId="",this.categories=[],this.checked=[],this.form=this.fb.group({name:["",[v.required,v.maxLength(100)]],email:["",[v.required,v.maxLength(100)]],password:["",[v.maxLength(300)]]})}ngOnInit(){this.route.paramMap.subscribe(m=>{this.editId=m.get("id"),this.getRecord(this.editId)})}getRecord(m){return x(this,null,function*(){this.formLoader=!0,this.service.list({id:Number(this.editId),limit:1}).subscribe({next:s=>{let e=s.data.data[0];this.form.patchValue({name:e.name,email:e.email,password:""}),this.checked=e.permissions,this.notification.success(s.message),this.formLoader=!1},error:s=>{let e=s.error;e?e.errors?this.notification.error(Object.values(e.errors)[0]):this.notification.error(e.message):this.notification.error("Something Went Wrong"),this.formLoader=!1,this.router.navigate(["/admin/dashboard"])}})})}onSubmit(){return x(this,null,function*(){if(this.form.valid){let m=this.form.value;m.id=this.editId,this.formLoader=!0;let s=document.querySelectorAll(".permission-checkbox"),e=Array.from(s).filter(l=>l.checked).map(l=>l.name);m.permissions=e.join(","),this.service.update(m).subscribe({next:l=>{this.formLoader=!1,this.notification.success(l.message),this.router.navigate(["/admin/users/list"]),this.getRecord(this.editId),this.formLoader=!1},error:l=>{let p=l.error;p?p.errors?this.notification.error(Object.values(p.errors)[0]):this.notification.error(p.message):this.notification.error("Something Went Wrong"),this.formLoader=!1}})}else this.formLoader=!1,this.form.markAllAsTouched(),this.notification.error("Validation Failed")})}};d.\u0275fac=function(s){return new(s||d)(f(W),f(j),f(q),f(P),f(L),f(N),f(k),f(M))},d.\u0275cmp=y({type:d,selectors:[["app-user-edit"]],standalone:!0,features:[C],decls:49,vars:12,consts:[[1,"row","page-titles"],[1,"col-md-5","align-self-center"],[1,"text-themecolor"],[1,"col-md-7","align-self-center","text-end"],[1,"d-flex","justify-content-end","align-items-center"],[1,"breadcrumb","justify-content-end"],[1,"breadcrumb-item"],["href","javascript:void(0)"],[1,"breadcrumb-item","active"],[1,"row"],[1,"col-lg-12"],[1,"card"],[1,"card-header","bg-info"],[1,"mb-0","text-white"],[1,"card-body"],[1,"text-center",3,"ngClass"],[3,"ngSubmit","ngClass","formGroup"],[1,"row","pt-3"],[1,"col-md-6"],[1,"form-group"],[1,"form-label"],["formControlName","name","placeholder","Name",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","email","placeholder","Email",1,"form-control"],["type","password","formControlName","password","placeholder","password",1,"form-control"],[1,"col-md-12"],[1,"d-flex","flex-wrap"],["class","p-3 permission-boxes",4,"ngFor","ngForOf"],[1,"col-md-12","text-center"],["type","submit",1,"btn","btn-info","text-white",3,"disabled"],[1,"text-danger"],[1,"p-3","permission-boxes"],["type","checkbox",1,"permission-checkbox",3,"name","checked","id","value"],[1,"px-2",3,"for"]],template:function(s,e){s&1&&(i(0,"div",0)(1,"div",1)(2,"h4",2),n(3,"Edit User"),t()(),i(4,"div",3)(5,"div",4)(6,"ol",5)(7,"li",6)(8,"a",7),n(9,"Home"),t()(),i(10,"li",8),n(11,"Users"),t()()()()(),i(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"h4",13),n(17,"Edit User Form"),t()(),i(18,"div",14)(19,"p",15),n(20,"Loader"),t(),i(21,"form",16),E("ngSubmit",function(){return e.onSubmit()}),i(22,"div",17)(23,"div",18)(24,"div",19)(25,"label",20),n(26,"Name"),t(),h(27,"input",21),u(28,J,2,1,"div",22),t()(),i(29,"div",18)(30,"div",19)(31,"label",20),n(32,"Email"),t(),h(33,"input",23),u(34,K,2,1,"div",22),t()(),i(35,"div",18)(36,"div",19)(37,"label",20),n(38,"Password"),t(),h(39,"input",24),u(40,Q,2,1,"div",22),t()(),i(41,"div",25)(42,"label",20),n(43,"Permissions:"),t(),i(44,"div",26),u(45,X,4,6,"div",27),t()(),i(46,"div",28)(47,"button",29),n(48,"Submit"),t()()()()()()()()),s&2&&(a(19),c("ngClass",S(8,B,!e.formLoader)),a(2),c("ngClass",S(10,B,e.formLoader))("formGroup",e.form),a(7),c("ngIf",e.form.controls.name.invalid&&(e.form.controls.name.dirty||e.form.controls.name.touched)),a(6),c("ngIf",e.form.controls.email.invalid&&(e.form.controls.email.dirty||e.form.controls.email.touched)),a(6),c("ngIf",e.form.controls.password.invalid&&(e.form.controls.password.dirty||e.form.controls.password.touched)),a(5),c("ngForOf",e.service.adminService.permissions),a(2),c("disabled",e.formLoader))},dependencies:[w,I,_,F,G,O,U,A,T,R,V,D],encapsulation:2});let r=d;return r})();export{pe as UserEditComponent};
