import{i as p,j as o,k as u,l as h,s as m,v as f,w as g}from"./chunk-565UEWQH.js";import{O as c,T as r,ra as d}from"./chunk-B5DXUUC7.js";import{d as l}from"./chunk-4CLCTAJ7.js";var H=(()=>{let i=class i{constructor(e,t,s,a){this.platformId=e,this.http=t,this.router=s,this.appService=a,this.p=[],this.permissions=["dashboard","users.menu","users.list","users.create","users.edit","users.delete","destacados.menu","destacados.list","destacados.create","destacados.edit","destacados.delete","events.menu","events.list","events.create","events.edit","events.delete","pdf.menu","pdf.list","pdf.create","pdf.edit","pdf.delete","document.menu","document.list","document.create","document.edit","document.delete","course.menu","course.list","course.create","course.edit","course.delete","webinars.menu","webinars.list","webinars.create","webinars.edit","webinars.delete","newsletter.menu","newsletter.list","newsletter.delete","filemanager.menu","filemanager.list","filemanger.edit","filemanager.add","filemanager.delete","home.page","quienes_somos.page","cooperacion.page","investigacion_y_documentos.page","noticias.page","repository.page","escuela.page","oportunidades.page","eventos.page"],this.apiUrl=f.apiUrl,this.token=null,this.auth=!1,this.user=[]}register(e,t,s){let a=`${this.apiUrl}/api/admin/auth/register`,v={fullname:e,email:t,password:s};return this.http.post(a,v,{headers:new o({"Content-Type":"application/json"})})}login(e,t){let s=`${this.apiUrl}/api/admin/auth/login`,a={email:e,password:t};return this.http.post(s,a,{headers:new o({"Content-Type":"application/json"})})}isAuthenticated(){return p(this.platformId)?!!localStorage.getItem("token"):!1}setAuth(){return l(this,null,function*(){if(p(this.platformId)){let e=yield localStorage.getItem("token");e?(this.token=e,this.auth=!0,this.getAuth(e).subscribe({next:t=>{this.user=t.data,this.p=t.data.permissions},error:t=>{localStorage.removeItem("token"),this.token=null,this.auth=!1,this.appService.apploading=!1}})):(this.token=null,this.auth=!1)}})}getAuth(e){let t=new u;return this.http.get(`${this.apiUrl}/api/admin/profile`,{params:t,headers:new o({Authorization:`Bearer ${e}`,"Content-Type":"application/json"})})}logout(){return l(this,null,function*(){this.appService.apploading=!0,(yield localStorage.getItem("token"))?(localStorage.removeItem("token"),this.token=null,this.auth=!1,this.appService.apploading=!1):(this.token=null,this.auth=!1,this.appService.apploading=!1)})}};i.\u0275fac=function(t){return new(t||i)(r(d),r(h),r(m),r(g))},i.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();export{H as a};
